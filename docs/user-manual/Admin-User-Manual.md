# DMH权限管理系统 - 管理员使用手册

## 概述

本手册面向DMH数字营销中台的系统管理员，详细介绍了RBAC权限管理系统的使用方法、功能特性和最佳实践。

## 目录

1. [系统登录](#系统登录)
2. [用户管理](#用户管理)
3. [角色权限管理](#角色权限管理)
4. [品牌管理](#品牌管理)
5. [菜单权限管理](#菜单权限管理)
6. [安全管理](#安全管理)
7. [系统监控](#系统监控)
8. [常见问题](#常见问题)

## 系统登录

### 访问系统

1. 打开浏览器，访问管理后台地址：`https://admin.dmh.com`
2. 输入用户名和密码
3. 点击"登录"按钮

![登录界面](../images/login-page.png)

### 登录要求

- **用户名**: 3-50个字符，支持字母、数字、下划线
- **密码**: 符合密码策略要求
  - 最少8位字符
  - 包含大写字母、小写字母、数字和特殊字符
  - 不能使用最近5次使用过的密码

### 登录安全

- 连续登录失败5次将锁定账户30分钟
- 系统会记录所有登录尝试
- 支持多设备登录，但有并发会话限制

## 用户管理

### 用户列表

在左侧菜单中选择"用户管理" > "用户列表"，可以查看所有系统用户。

![用户列表](../images/user-list.png)

#### 功能说明

- **搜索过滤**: 支持按用户名、手机号、角色、状态进行搜索
- **状态标识**: 
  - 🟢 活跃 (active)
  - 🔴 禁用 (disabled)
  - 🔒 锁定 (locked)
- **操作按钮**: 编辑、重置密码、删除、查看详情

### 创建用户

点击"新增用户"按钮，填写用户信息：

![创建用户](../images/create-user.png)

#### 必填信息

- **用户名**: 系统唯一标识
- **密码**: 符合密码策略
- **手机号**: 11位手机号码
- **角色**: 选择用户角色
  - 平台管理员：拥有所有权限
  - 品牌管理员：管理分配的品牌
  - 参与者：基础查看权限

#### 可选信息

- **邮箱**: 用于通知和找回密码
- **真实姓名**: 用户真实姓名
- **品牌分配**: 为品牌管理员分配管理的品牌

### 编辑用户

点击用户列表中的"编辑"按钮，可以修改用户信息：

- 基本信息（姓名、邮箱等）
- 角色变更
- 状态管理（启用/禁用/解锁）
- 品牌权限分配

### 重置密码

为用户重置密码的步骤：

1. 在用户列表中点击"重置密码"
2. 输入新密码（需符合密码策略）
3. 确认重置
4. 通知用户新密码

### 用户状态管理

#### 禁用用户
- 禁用后用户无法登录
- 保留用户数据和权限配置
- 可随时重新启用

#### 锁定用户
- 临时锁定，可设置解锁时间
- 用于安全事件处理
- 自动解锁或手动解锁

#### 删除用户
- 永久删除用户及相关数据
- 谨慎操作，建议先禁用观察
- 删除前确认无重要业务关联

## 角色权限管理

### 角色概览

系统预定义四种角色：

| 角色 | 权限范围 | 适用场景 |
|------|----------|----------|
| 平台管理员 | 所有权限 | 系统管理员 |
| 品牌管理员 | 品牌相关权限 | 品牌运营人员 |
| 参与者 | 基础查看权限 | 普通用户 |
| 匿名用户 | 公开接口权限 | 未登录用户 |

### 权限配置

在"系统管理" > "角色管理"中配置角色权限：

![角色权限配置](../images/role-permission.png)

#### 权限类别

1. **用户管理权限**
   - `user:manage`: 用户管理权限
   - 包括创建、编辑、删除用户

2. **品牌管理权限**
   - `brand:manage`: 品牌管理权限
   - 包括品牌信息、素材、统计

3. **活动管理权限**
   - `campaign:manage`: 活动管理权限
   - 包括活动创建、配置、监控

4. **订单权限**
   - `order:read`: 订单查看权限
   - 查看订单信息和统计

5. **安全管理权限**
   - `security:manage`: 安全管理权限
   - 包括审计日志、会话管理

#### 配置步骤

1. 选择要配置的角色
2. 勾选需要分配的权限
3. 点击"保存配置"
4. 系统自动更新用户权限

### 权限验证

系统采用多层权限验证：

1. **接口权限**: 验证用户是否有调用接口的权限
2. **数据权限**: 验证用户是否有访问特定数据的权限
3. **品牌权限**: 验证品牌管理员是否有访问特定品牌的权限

## 品牌管理

### 品牌列表

在"品牌管理"菜单中查看所有品牌：

![品牌列表](../images/brand-list.png)

- **平台管理员**: 可以看到所有品牌
- **品牌管理员**: 只能看到分配给自己的品牌

### 创建品牌

点击"新增品牌"创建新品牌：

![创建品牌](../images/create-brand.png)

#### 品牌信息

- **品牌名称**: 品牌的显示名称
- **品牌Logo**: 上传品牌Logo图片
- **品牌描述**: 品牌的详细描述

### 品牌管理员分配

在"品牌管理" > "管理员分配"中管理品牌管理员：

![品牌管理员分配](../images/brand-admin-assignment.png)

#### 分配流程

1. 选择品牌管理员用户
2. 选择要分配的品牌（支持多选）
3. 确认分配关系
4. 系统自动更新权限

#### 分配规则

- 一个品牌管理员可以管理多个品牌
- 一个品牌可以分配给多个管理员
- 平台管理员自动拥有所有品牌权限

### 品牌素材管理

品牌管理员可以管理品牌素材：

![品牌素材管理](../images/brand-assets.png)

#### 素材类型

- **图片**: JPG, PNG, GIF格式
- **视频**: MP4, AVI格式
- **文档**: PDF, DOC, PPT格式

#### 素材分类

- **Logo**: 品牌标识
- **Banner**: 宣传横幅
- **Product**: 产品图片
- **Marketing**: 营销素材

### 品牌数据统计

查看品牌运营数据：

![品牌统计](../images/brand-stats.png)

#### 统计指标

- **活动数量**: 总活动数和活跃活动数
- **订单统计**: 订单数量和金额
- **用户参与**: 参与用户数和转化率
- **奖励发放**: 奖励金额和发放情况

## 菜单权限管理

### 菜单结构

系统支持两套菜单：

1. **管理后台菜单**: 面向管理员的功能菜单
2. **H5前端菜单**: 面向普通用户的功能菜单

### 菜单配置

在"系统管理" > "菜单管理"中配置菜单：

![菜单管理](../images/menu-management.png)

#### 菜单属性

- **菜单名称**: 显示的菜单名称
- **菜单编码**: 系统内部标识
- **菜单路径**: 前端路由路径
- **菜单图标**: 显示的图标
- **父级菜单**: 构建菜单层级
- **排序**: 菜单显示顺序
- **菜单类型**: 
  - menu: 菜单项
  - button: 按钮权限
- **平台类型**:
  - admin: 管理后台
  - h5: H5前端

### 角色菜单权限

为不同角色配置可见菜单：

![角色菜单配置](../images/role-menu-config.png)

#### 配置原则

- 按角色分配菜单权限
- 支持菜单继承（父菜单权限包含子菜单）
- 动态菜单加载（根据用户权限显示）

### 动态菜单

系统根据用户权限动态生成菜单：

1. 用户登录后获取角色信息
2. 查询角色对应的菜单权限
3. 构建菜单树结构
4. 前端动态渲染菜单

## 安全管理

### 密码策略

在"安全管理" > "密码策略"中配置密码规则：

![密码策略](../images/password-policy.png)

#### 策略配置

- **最小长度**: 密码最少字符数
- **字符要求**: 大写字母、小写字母、数字、特殊字符
- **密码有效期**: 密码过期天数
- **历史密码**: 禁止重复使用的历史密码数量
- **登录限制**: 最大登录失败次数和锁定时长
- **会话管理**: 会话超时时间和最大并发会话数

### 审计日志

查看系统操作审计日志：

![审计日志](../images/audit-logs.png)

#### 日志内容

- **操作时间**: 操作发生的时间
- **操作用户**: 执行操作的用户
- **操作类型**: 具体的操作类型
- **操作资源**: 操作的资源对象
- **操作结果**: 成功或失败
- **详细信息**: 操作的详细描述
- **客户端信息**: IP地址和用户代理

#### 日志查询

- 按时间范围查询
- 按用户过滤
- 按操作类型过滤
- 按操作结果过滤

### 登录尝试监控

监控系统登录尝试：

![登录尝试](../images/login-attempts.png)

#### 监控指标

- **登录时间**: 尝试登录的时间
- **用户名**: 尝试登录的用户名
- **登录结果**: 成功或失败
- **失败原因**: 登录失败的具体原因
- **客户端信息**: IP地址和设备信息

#### 安全分析

- 识别暴力破解攻击
- 监控异常登录行为
- 分析登录模式和趋势

### 用户会话管理

管理活跃用户会话：

![会话管理](../images/session-management.png)

#### 会话信息

- **会话ID**: 唯一会话标识
- **用户信息**: 会话对应的用户
- **登录时间**: 会话开始时间
- **最后活跃**: 最后一次活动时间
- **过期时间**: 会话过期时间
- **客户端信息**: 登录设备和位置

#### 会话操作

- **撤销会话**: 强制结束特定会话
- **强制下线**: 强制用户下线所有会话
- **会话延期**: 延长会话有效期

### 安全事件处理

处理系统安全事件：

![安全事件](../images/security-events.png)

#### 事件类型

- **频繁登录失败**: 短时间内多次登录失败
- **异常IP登录**: 从新IP地址登录
- **权限提升**: 尝试获取更高权限
- **账户锁定**: 账户被自动锁定
- **强制下线**: 管理员强制用户下线

#### 事件处理

1. 查看事件详情
2. 分析安全风险
3. 采取相应措施
4. 标记事件为已处理

## 系统监控

### 系统状态

监控系统运行状态：

![系统监控](../images/system-monitoring.png)

#### 监控指标

- **服务状态**: 各个服务的运行状态
- **系统资源**: CPU、内存、磁盘使用情况
- **数据库状态**: 数据库连接和性能
- **接口响应**: API接口响应时间
- **错误统计**: 系统错误数量和类型

### 性能分析

分析系统性能指标：

- **响应时间**: 接口平均响应时间
- **并发用户**: 同时在线用户数
- **数据库性能**: 查询执行时间
- **缓存命中率**: 权限缓存效果

### 告警设置

配置系统告警规则：

- **资源告警**: CPU、内存使用率过高
- **错误告警**: 错误率超过阈值
- **安全告警**: 安全事件触发
- **业务告警**: 关键业务指标异常

## 最佳实践

### 用户管理最佳实践

1. **最小权限原则**
   - 只分配必要的权限
   - 定期审查用户权限
   - 及时回收离职员工权限

2. **账户安全**
   - 强制使用强密码
   - 定期更换密码
   - 启用多因素认证

3. **权限分离**
   - 管理员和普通用户分离
   - 开发和生产环境分离
   - 不同业务线权限分离

### 品牌管理最佳实践

1. **数据隔离**
   - 确保品牌数据完全隔离
   - 定期验证权限边界
   - 监控跨品牌访问尝试

2. **权限分配**
   - 按业务需要分配品牌权限
   - 避免过度授权
   - 建立权限申请流程

### 安全管理最佳实践

1. **密码策略**
   - 设置合理的密码复杂度要求
   - 定期更新密码策略
   - 监控密码安全事件

2. **审计监控**
   - 启用全面的操作审计
   - 定期分析审计日志
   - 建立安全事件响应流程

3. **会话管理**
   - 设置合理的会话超时时间
   - 限制并发会话数量
   - 监控异常会话行为

## 常见问题

### Q1: 用户忘记密码怎么办？

**A**: 管理员可以为用户重置密码：
1. 在用户列表中找到该用户
2. 点击"重置密码"按钮
3. 输入新密码
4. 通知用户新密码

### Q2: 如何为品牌管理员分配多个品牌？

**A**: 在品牌管理员分配页面：
1. 选择品牌管理员用户
2. 在品牌列表中勾选多个品牌
3. 点击"保存分配"
4. 系统自动更新权限

### Q3: 用户账户被锁定如何解锁？

**A**: 有两种解锁方式：
1. **自动解锁**: 等待锁定时间到期
2. **手动解锁**: 管理员在用户管理中手动解锁

### Q4: 如何查看某个用户的操作记录？

**A**: 在审计日志中查看：
1. 进入"安全管理" > "审计日志"
2. 在用户名过滤框中输入用户名
3. 设置时间范围
4. 点击查询

### Q5: 品牌管理员看不到某个品牌怎么办？

**A**: 检查品牌权限分配：
1. 确认用户角色是品牌管理员
2. 检查品牌管理员分配中是否包含该品牌
3. 如果没有，重新分配品牌权限

### Q6: 如何批量导入用户？

**A**: 目前系统不支持批量导入，需要逐个创建用户。建议：
1. 准备用户信息清单
2. 按角色分类创建
3. 统一分配权限

### Q7: 系统响应慢怎么排查？

**A**: 按以下步骤排查：
1. 检查系统监控指标
2. 查看数据库性能
3. 分析慢查询日志
4. 检查网络连接
5. 联系技术支持

### Q8: 如何备份重要数据？

**A**: 系统自动备份，也可以手动备份：
1. 数据库每日自动备份
2. 重要配置文件备份
3. 用户上传文件备份
4. 可联系管理员获取备份文件

## 技术支持

如果遇到本手册未涵盖的问题，请联系技术支持：

- **邮箱**: support@dmh.com
- **电话**: 400-xxx-xxxx
- **工作时间**: 周一至周五 9:00-18:00

## 附录

### A. 快捷键参考

| 功能 | 快捷键 | 说明 |
|------|--------|------|
| 全局搜索 | Ctrl + K | 快速搜索功能和数据 |
| 刷新页面 | F5 | 刷新当前页面数据 |
| 返回上级 | Alt + ← | 返回上一个页面 |
| 保存 | Ctrl + S | 保存当前表单 |
| 取消 | Esc | 取消当前操作 |

### B. 权限编码参考

| 权限编码 | 权限名称 | 说明 |
|----------|----------|------|
| user:manage | 用户管理 | 创建、编辑、删除用户 |
| user:read | 用户查看 | 查看用户信息 |
| brand:manage | 品牌管理 | 管理品牌信息和素材 |
| brand:read | 品牌查看 | 查看品牌信息 |
| campaign:manage | 活动管理 | 创建和管理营销活动 |
| campaign:read | 活动查看 | 查看活动信息 |
| order:read | 订单查看 | 查看订单信息 |
| security:manage | 安全管理 | 管理安全策略和审计 |
| role:manage | 角色管理 | 管理角色和权限 |
| menu:manage | 菜单管理 | 管理系统菜单 |

### C. 状态码参考

#### 用户状态
- **active**: 正常活跃状态
- **disabled**: 已禁用，无法登录
- **locked**: 已锁定，临时无法登录

#### 品牌状态
- **active**: 正常使用状态
- **disabled**: 已禁用，暂停使用

#### 会话状态
- **active**: 活跃会话
- **expired**: 已过期
- **revoked**: 已撤销

### D. 错误代码参考

| 错误代码 | 错误信息 | 解决方案 |
|----------|----------|----------|
| 10001 | 用户名或密码错误 | 检查用户名和密码是否正确 |
| 10003 | 用户已被禁用 | 联系管理员启用账户 |
| 10004 | 用户已被锁定 | 等待自动解锁或联系管理员 |
| 20001 | 权限不足 | 联系管理员分配相应权限 |
| 20002 | 品牌权限不足 | 联系管理员分配品牌权限 |
| 40001 | 资源不存在 | 检查资源是否已被删除 |
| 50001 | 系统内部错误 | 联系技术支持 |

## 版本信息

- **手册版本**: v1.0
- **系统版本**: v1.0
- **更新日期**: 2024年1月
- **适用范围**: DMH RBAC权限管理系统

## 更新日志

### v1.0 (2024年1月)
- 初始版本发布
- 完整的用户管理功能
- 品牌管理和权限控制
- 安全管理和审计功能
- 菜单权限动态控制

---

*本手册将根据系统更新持续维护，请关注最新版本。如有疑问或建议，请联系技术支持团队。*